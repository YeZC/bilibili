package com.yzc.video.backup

import android.content.Context
import com.yzc.base.BiliCore
import com.yzc.base.ktexpand.getUriValue
import org.json.JSONObject
import org.junit.Test
import org.junit.runner.RunWith
import org.mockito.Mock
import org.mockito.junit.MockitoJUnitRunner
import java.net.URLDecoder

@RunWith(MockitoJUnitRunner::class)
internal class VideoFlowNetTest {

    @Mock
    private lateinit var mockContext: Context

    @Test
    fun decode(){
        val uri = "bilibili://story/554902946?cid=747074406&player_height=1920&player_preload=%7B%22expire_time%22%3A1656055115%2C%22cid%22%3A747074406%2C%22quality%22%3A80%2C%22file_info%22%3A%7B%22116%22%3A%7B%22infos%22%3A%5B%7B%22filesize%22%3A62103770%2C%22timelength%22%3A95262%7D%5D%7D%2C%2216%22%3A%7B%22infos%22%3A%5B%7B%22filesize%22%3A4174593%2C%22timelength%22%3A95279%7D%5D%7D%2C%2232%22%3A%7B%22infos%22%3A%5B%7B%22filesize%22%3A7948004%2C%22timelength%22%3A95279%7D%5D%7D%2C%2264%22%3A%7B%22infos%22%3A%5B%7B%22filesize%22%3A16818599%2C%22timelength%22%3A95279%7D%5D%7D%2C%2280%22%3A%7B%22infos%22%3A%5B%7B%22filesize%22%3A27705163%2C%22timelength%22%3A95279%7D%5D%7D%7D%2C%22video_codecid%22%3A7%2C%22video_project%22%3Atrue%2C%22fnver%22%3A0%2C%22fnval%22%3A400%2C%22dash%22%3A%7B%22video%22%3A%5B%7B%22id%22%3A80%2C%22base_url%22%3A%22http%3A%2F%2F121.205.162.53%3A4480%2Fupgcxcode%2F06%2F44%2F747074406%2F747074406-1-31101.m4s%3Fe%3Dig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_%5Cu0026uipk%3D5%5Cu0026nbs%3D1%5Cu0026deadline%3D1656058715%5Cu0026gen%3Dplayurlv2%5Cu0026os%3Dmcdn%5Cu0026oi%3D3070630519%5Cu0026trid%3D00009116131387a743b09a9097ae22efacdfO%5Cu0026mid%3D0%5Cu0026platform%3Diphone%5Cu0026upsig%3Da3e7caec8b2c3e004badbaa2afc89c93%5Cu0026uparams%3De%2Cuipk%2Cnbs%2Cdeadline%2Cgen%2Cos%2Coi%2Ctrid%2Cmid%2Cplatform%5Cu0026mcdnid%3D11000107%5Cu0026bvc%3Dvod%5Cu0026nettype%3D1%5Cu0026orderid%3D0%2C2%5Cu0026bw%3D164780%5Cu0026logo%3DA0000400%22%2C%22bandwidth%22%3A1315015%2C%22codecid%22%3A12%2C%22size%22%3A15654108%2C%22backup_url%22%3A%5B%22http%3A%2F%2F59.63.74.42%3A9102%2Fupgcxcode%2F06%2F44%2F747074406%2F747074406-1-31101.m4s%3Fxyip%3D59.63.74.42%5Cu0026xyport%3D9102%5Cu0026xy_usource%3Dupos-sz-mirrorhw.bilivideo.com%5Cu0026xy_mark%3Drsc-upos-sz-mirrorhw.disp.bilivideo.com%5Cu0026e%3Dig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_%5Cu0026uipk%3D5%5Cu0026nbs%3D1%5Cu0026deadline%3D1656058715%5Cu0026gen%3Dplayurlv2%5Cu0026os%3Drsc%5Cu0026oi%3D3070630519%5Cu0026trid%3D9116131387a743b09a9097ae22efacdfO%5Cu0026mid%3D0%5Cu0026platform%3Diphone%5Cu0026upsig%3Ddadecbd5cc02166b7871bb2b6a6556a6%5Cu0026uparams%3De%2Cuipk%2Cnbs%2Cdeadline%2Cgen%2Cos%2Coi%2Ctrid%2Cmid%2Cplatform%5Cu0026pcdnid%3D1000007494%5Cu0026bvc%3Dvod%5Cu0026nettype%3D1%5Cu0026orderid%3D1%2C2%5Cu0026bw%3D164780%5Cu0026logo%3D40000000%22%5D%2C%22frame_rate%22%3A%2230.303%22%7D%2C%7B%22id%22%3A80%2C%22base_url%22%3A%22http%3A%2F%2F110.85.56.57%3A4480%2Fupgcxcode%2F06%2F44%2F747074406%2F747074406_nb3-1-30080.m4s%3Fe%3Dig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_%5Cu0026uipk%3D5%5Cu0026nbs%3D1%5Cu0026deadline%3D1656058715%5Cu0026gen%3Dplayurlv2%5Cu0026os%3Dmcdn%5Cu0026oi%3D3070630519%5Cu0026trid%3D00009116131387a743b09a9097ae22efacdfO%5Cu0026mid%3D0%5Cu0026platform%3Diphone%5Cu0026upsig%3D120f5e06254711ae72adc2f9d06df8cc%5Cu0026uparams%3De%2Cuipk%2Cnbs%2Cdeadline%2Cgen%2Cos%2Coi%2Ctrid%2Cmid%2Cplatform%5Cu0026mcdnid%3D11000045%5Cu0026bvc%3Dvod%5Cu0026nettype%3D1%5Cu0026orderid%3D0%2C2%5Cu0026bw%3D291633%5Cu0026logo%3DA0000400%22%2C%22bandwidth%22%3A2327358%2C%22codecid%22%3A7%2C%22size%22%3A27705163%2C%22backup_url%22%3A%5B%22http%3A%2F%2F222.78.42.171%3A9102%2Fupgcxcode%2F06%2F44%2F747074406%2F747074406_nb3-1-30080.m4s%3Fxyip%3D222.78.42.171%5Cu0026xyport%3D9102%5Cu0026xy_usource%3Dupos-sz-mirrorhw.bilivideo.com%5Cu0026xy_mark%3Drsc-upos-sz-mirrorhw.disp.bilivideo.com%5Cu0026e%3Dig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_%5Cu0026uipk%3D5%5Cu0026nbs%3D1%5Cu0026deadline%3D1656058715%5Cu0026gen%3Dplayurlv2%5Cu0026os%3Drsc%5Cu0026oi%3D3070630519%5Cu0026trid%3D9116131387a743b09a9097ae22efacdfO%5Cu0026mid%3D0%5Cu0026platform%3Diphone%5Cu0026upsig%3D2848b71a513faa34046dad3ae7c8cb62%5Cu0026uparams%3De%2Cuipk%2Cnbs%2Cdeadline%2Cgen%2Cos%2Coi%2Ctrid%2Cmid%2Cplatform%5Cu0026pcdnid%3D1000005131%5Cu0026bvc%3Dvod%5Cu0026nettype%3D1%5Cu0026orderid%3D1%2C2%5Cu0026bw%3D291633%5Cu0026logo%3D40000000%22%5D%2C%22frame_rate%22%3A%2229.412%22%7D%2C%7B%22id%22%3A32%2C%22base_url%22%3A%22http%3A%2F%2F121.205.162.53%3A4480%2Fupgcxcode%2F06%2F44%2F747074406%2F747074406-1-31057.m4s%3Fe%3Dig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_%5Cu0026uipk%3D5%5Cu0026nbs%3D1%5Cu0026deadline%3D1656058715%5Cu0026gen%3Dplayurlv2%5Cu0026os%3Dmcdn%5Cu0026oi%3D3070630519%5Cu0026trid%3D00009116131387a743b09a9097ae22efacdfO%5Cu0026mid%3D0%5Cu0026platform%3Diphone%5Cu0026upsig%3D821f9cc913ab201c7dc4ba25dc8fccd2%5Cu0026uparams%3De%2Cuipk%2Cnbs%2Cdeadline%2Cgen%2Cos%2Coi%2Ctrid%2Cmid%2Cplatform%5Cu0026mcdnid%3D11000107%5Cu0026bvc%3Dvod%5Cu0026nettype%3D1%5Cu0026orderid%3D0%2C2%5Cu0026bw%3D45359%5Cu0026logo%3DA0000400%22%2C%22bandwidth%22%3A361991%2C%22codecid%22%3A12%2C%22size%22%3A4309187%2C%22backup_url%22%3A%5B%22http%3A%2F%2F222.78.42.171%3A9102%2Fupgcxcode%2F06%2F44%2F747074406%2F747074406-1-31057.m4s%3Fxyip%3D222.78.42.171%5Cu0026xyport%3D9102%5Cu0026xy_usource%3Dupos-sz-mirrorhw.bilivideo.com%5Cu0026xy_mark%3Drsc-upos-sz-mirrorhw.disp.bilivideo.com%5Cu0026e%3Dig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_%5Cu0026uipk%3D5%5Cu0026nbs%3D1%5Cu0026deadline%3D1656058715%5Cu0026gen%3Dplayurlv2%5Cu0026os%3Drsc%5Cu0026oi%3D3070630519%5Cu0026trid%3D9116131387a743b09a9097ae22efacdfO%5Cu0026mid%3D0%5Cu0026platform%3Diphone%5Cu0026upsig%3D35326aac9ca7e4deb769b145452d1da3%5Cu0026uparams%3De%2Cuipk%2Cnbs%2Cdeadline%2Cgen%2Cos%2Coi%2Ctrid%2Cmid%2Cplatform%5Cu0026pcdnid%3D1000005131%5Cu0026bvc%3Dvod%5Cu0026nettype%3D1%5Cu0026orderid%3D1%2C2%5Cu0026bw%3D45359%5Cu0026logo%3D40000000%22%5D%2C%22frame_rate%22%3A%2230.303%22%7D%2C%7B%22id%22%3A32%2C%22base_url%22%3A%22http%3A%2F%2F110.85.56.55%3A4480%2Fupgcxcode%2F06%2F44%2F747074406%2F747074406_nb3-1-30032.m4s%3Fe%3Dig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_%5Cu0026uipk%3D5%5Cu0026nbs%3D1%5Cu0026deadline%3D1656058715%5Cu0026gen%3Dplayurlv2%5Cu0026os%3Dmcdn%5Cu0026oi%3D3070630519%5Cu0026trid%3D00009116131387a743b09a9097ae22efacdfO%5Cu0026mid%3D0%5Cu0026platform%3Diphone%5Cu0026upsig%3D79c77295af773f351a420f49b07e91d3%5Cu0026uparams%3De%2Cuipk%2Cnbs%2Cdeadline%2Cgen%2Cos%2Coi%2Ctrid%2Cmid%2Cplatform%5Cu0026mcdnid%3D11000043%5Cu0026bvc%3Dvod%5Cu0026nettype%3D1%5Cu0026orderid%3D0%2C2%5Cu0026bw%3D83663%5Cu0026logo%3DA0000400%22%2C%22bandwidth%22%3A667668%2C%22codecid%22%3A7%2C%22size%22%3A7948004%2C%22backup_url%22%3A%5B%22http%3A%2F%2F125.108.19.201%3A9102%2Fupgcxcode%2F06%2F44%2F747074406%2F747074406_nb3-1-30032.m4s%3Fxyip%3D125.108.19.201%5Cu0026xyport%3D9102%5Cu0026xy_usource%3Dupos-sz-mirrorcosb.bilivideo.com%5Cu0026xy_mark%3Drsc-upos-sz-mirrorcosb.disp.bilivideo.com%5Cu0026e%3Dig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_%5Cu0026uipk%3D5%5Cu0026nbs%3D1%5Cu0026deadline%3D1656058715%5Cu0026gen%3Dplayurlv2%5Cu0026os%3Drsc%5Cu0026oi%3D3070630519%5Cu0026trid%3D9116131387a743b09a9097ae22efacdfO%5Cu0026mid%3D0%5Cu0026platform%3Diphone%5Cu0026upsig%3Da1e6930d6a42af9174ed9c08dd4bd23b%5Cu0026uparams%3De%2Cuipk%2Cnbs%2Cdeadline%2Cgen%2Cos%2Coi%2Ctrid%2Cmid%2Cplatform%5Cu0026pcdnid%3D1000007886%5Cu0026bvc%3Dvod%5Cu0026nettype%3D1%5Cu0026orderid%3D1%2C2%5Cu0026bw%3D83663%5Cu0026logo%3D40000000%22%5D%2C%22frame_rate%22%3A%2229.412%22%7D%5D%2C%22audio%22%3A%5B%7B%22id%22%3A30216%2C%22base_url%22%3A%22http%3A%2F%2F218.85.123.2%3A4480%2Fupgcxcode%2F06%2F44%2F747074406%2F747074406_nb3-1-30216.m4s%3Fe%3Dig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_%5Cu0026uipk%3D5%5Cu0026nbs%3D1%5Cu0026deadline%3D1656058715%5Cu0026gen%3Dplayurlv2%5Cu0026os%3Dmcdn%5Cu0026oi%3D3070630519%5Cu0026trid%3D00009116131387a743b09a9097ae22efacdfO%5Cu0026mid%3D0%5Cu0026platform%3Diphone%5Cu0026upsig%3D8f3b27b121f401a9293e78326dc19724%5Cu0026uparams%3De%2Cuipk%2Cnbs%2Cdeadline%2Cgen%2Cos%2Coi%2Ctrid%2Cmid%2Cplatform%5Cu0026mcdnid%3D11000077%5Cu0026bvc%3Dvod%5Cu0026nettype%3D1%5Cu0026orderid%3D0%2C2%5Cu0026bw%3D8446%5Cu0026logo%3DA0000400%22%2C%22bandwidth%22%3A67365%2C%22codecid%22%3A0%2C%22size%22%3A802436%2C%22backup_url%22%3A%5B%22http%3A%2F%2F115.219.197.247%3A9102%2Fupgcxcode%2F06%2F44%2F747074406%2F747074406_nb3-1-30216.m4s%3Fxyip%3D115.219.197.247%5Cu0026xyport%3D9102%5Cu0026xy_usource%3Dupos-sz-mirrorcos.bilivideo.com%5Cu0026xy_mark%3Drsc-upos-sz-mirrorcos.disp.bilivideo.com%5Cu0026e%3Dig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_%5Cu0026uipk%3D5%5Cu0026nbs%3D1%5Cu0026deadline%3D1656058715%5Cu0026gen%3Dplayurlv2%5Cu0026os%3Drsc%5Cu0026oi%3D3070630519%5Cu0026trid%3D9116131387a743b09a9097ae22efacdfO%5Cu0026mid%3D0%5Cu0026platform%3Diphone%5Cu0026upsig%3D4c31fa71d24fcd6f3690e45b680894c4%5Cu0026uparams%3De%2Cuipk%2Cnbs%2Cdeadline%2Cgen%2Cos%2Coi%2Ctrid%2Cmid%2Cplatform%5Cu0026pcdnid%3D1000007807%5Cu0026bvc%3Dvod%5Cu0026nettype%3D1%5Cu0026orderid%3D1%2C2%5Cu0026bw%3D8446%5Cu0026logo%3D40000000%22%5D%7D%2C%7B%22id%22%3A30232%2C%22base_url%22%3A%22http%3A%2F%2F110.85.56.57%3A4480%2Fupgcxcode%2F06%2F44%2F747074406%2F747074406_nb3-1-30232.m4s%3Fe%3Dig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_%5Cu0026uipk%3D5%5Cu0026nbs%3D1%5Cu0026deadline%3D1656058715%5Cu0026gen%3Dplayurlv2%5Cu0026os%3Dmcdn%5Cu0026oi%3D3070630519%5Cu0026trid%3D00009116131387a743b09a9097ae22efacdfO%5Cu0026mid%3D0%5Cu0026platform%3Diphone%5Cu0026upsig%3Db99fa54ad947223f10a75109aa0a8a3b%5Cu0026uparams%3De%2Cuipk%2Cnbs%2Cdeadline%2Cgen%2Cos%2Coi%2Ctrid%2Cmid%2Cplatform%5Cu0026mcdnid%3D11000045%5Cu0026bvc%3Dvod%5Cu0026nettype%3D1%5Cu0026orderid%3D0%2C2%5Cu0026bw%3D16202%5Cu0026logo%3DA0000400%22%2C%22bandwidth%22%3A129220%2C%22codecid%22%3A0%2C%22size%22%3A1539245%2C%22backup_url%22%3A%5B%22http%3A%2F%2F125.108.38.94%3A9102%2Fupgcxcode%2F06%2F44%2F747074406%2F747074406_nb3-1-30232.m4s%3Fxyip%3D125.108.38.94%5Cu0026xyport%3D9102%5Cu0026xy_usource%3Dupos-sz-mirrorbs.bilivideo.com%5Cu0026xy_mark%3Drsc-upos-sz-mirrorbs.disp.bilivideo.com%5Cu0026e%3Dig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_%5Cu0026uipk%3D5%5Cu0026nbs%3D1%5Cu0026deadline%3D1656058715%5Cu0026gen%3Dplayurlv2%5Cu0026os%3Drsc%5Cu0026oi%3D3070630519%5Cu0026trid%3D9116131387a743b09a9097ae22efacdfO%5Cu0026mid%3D0%5Cu0026platform%3Diphone%5Cu0026upsig%3Dace3d1d764b1a9d0967e0c67f685d1f0%5Cu0026uparams%3De%2Cuipk%2Cnbs%2Cdeadline%2Cgen%2Cos%2Coi%2Ctrid%2Cmid%2Cplatform%5Cu0026pcdnid%3D1000007982%5Cu0026bvc%3Dvod%5Cu0026nettype%3D1%5Cu0026orderid%3D1%2C2%5Cu0026bw%3D16202%5Cu0026logo%3D40000000%22%5D%7D%2C%7B%22id%22%3A30280%2C%22base_url%22%3A%22http%3A%2F%2F218.85.123.2%3A4480%2Fupgcxcode%2F06%2F44%2F747074406%2F747074406_nb3-1-30280.m4s%3Fe%3Dig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_%5Cu0026uipk%3D5%5Cu0026nbs%3D1%5Cu0026deadline%3D1656058715%5Cu0026gen%3Dplayurlv2%5Cu0026os%3Dmcdn%5Cu0026oi%3D3070630519%5Cu0026trid%3D00009116131387a743b09a9097ae22efacdfO%5Cu0026mid%3D0%5Cu0026platform%3Diphone%5Cu0026upsig%3Dec4bfdba647872249f321eb60032cc0a%5Cu0026uparams%3De%2Cuipk%2Cnbs%2Cdeadline%2Cgen%2Cos%2Coi%2Ctrid%2Cmid%2Cplatform%5Cu0026mcdnid%3D11000077%5Cu0026bvc%3Dvod%5Cu0026nettype%3D1%5Cu0026orderid%3D0%2C2%5Cu0026bw%3D16202%5Cu0026logo%3DA0000400%22%2C%22bandwidth%22%3A129220%2C%22codecid%22%3A0%2C%22size%22%3A1539245%2C%22backup_url%22%3A%5B%22http%3A%2F%2F115.221.174.138%3A9102%2Fupgcxcode%2F06%2F44%2F747074406%2F747074406_nb3-1-30280.m4s%3Fxyip%3D115.221.174.138%5Cu0026xyport%3D9102%5Cu0026xy_usource%3Dupos-sz-mirrorcos.bilivideo.com%5Cu0026xy_mark%3Drsc-upos-sz-mirrorcos.disp.bilivideo.com%5Cu0026e%3Dig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_%5Cu0026uipk%3D5%5Cu0026nbs%3D1%5Cu0026deadline%3D1656058715%5Cu0026gen%3Dplayurlv2%5Cu0026os%3Drsc%5Cu0026oi%3D3070630519%5Cu0026trid%3D9116131387a743b09a9097ae22efacdfO%5Cu0026mid%3D0%5Cu0026platform%3Diphone%5Cu0026upsig%3Dc133e2d98c4b04baaf2cf6d102eda22b%5Cu0026uparams%3De%2Cuipk%2Cnbs%2Cdeadline%2Cgen%2Cos%2Coi%2Ctrid%2Cmid%2Cplatform%5Cu0026pcdnid%3D1000007678%5Cu0026bvc%3Dvod%5Cu0026nettype%3D1%5Cu0026orderid%3D1%2C2%5Cu0026bw%3D16202%5Cu0026logo%3D40000000%22%5D%7D%5D%7D%2C%22accept_formats%22%3A%5B%7B%22quality%22%3A116%2C%22format%22%3A%22flv_p60%22%2C%22description%22%3A%22%E9%AB%98%E6%B8%85%201080P60%22%2C%22new_description%22%3A%221080P%2060%E5%B8%A7%22%2C%22display_desc%22%3A%221080P%22%2C%22superscript%22%3A%2260%E5%B8%A7%22%2C%22need_vip%22%3Atrue%2C%22need_login%22%3Atrue%7D%2C%7B%22quality%22%3A80%2C%22format%22%3A%22flv%22%2C%22description%22%3A%22%E9%AB%98%E6%B8%85%201080P%22%2C%22new_description%22%3A%221080P%20%E9%AB%98%E6%B8%85%22%2C%22display_desc%22%3A%221080P%22%2C%22need_login%22%3Atrue%7D%2C%7B%22quality%22%3A64%2C%22format%22%3A%22flv720%22%2C%22description%22%3A%22%E9%AB%98%E6%B8%85%20720P%22%2C%22new_description%22%3A%22720P%20%E9%AB%98%E6%B8%85%22%2C%22display_desc%22%3A%22720P%22%2C%22need_login%22%3Atrue%7D%2C%7B%22quality%22%3A32%2C%22format%22%3A%22flv480%22%2C%22description%22%3A%22%E6%B8%85%E6%99%B0%20480P%22%2C%22new_description%22%3A%22480P%20%E6%B8%85%E6%99%B0%22%2C%22display_desc%22%3A%22480P%22%7D%2C%7B%22quality%22%3A16%2C%22format%22%3A%22mp4%22%2C%22description%22%3A%22%E6%B5%81%E7%95%85%20360P%22%2C%22new_description%22%3A%22360P%20%E6%B5%81%E7%95%85%22%2C%22display_desc%22%3A%22360P%22%7D%5D%7D&player_rotate=0&player_width=1080"
        var player_preload = URLDecoder.decode(uri).getUriValue("player_preload")
//        println(player_preload)
        val json = JSONObject(player_preload)
        println(json)
        // bilibili://story/256971413?cid=730580971
        // &player_height=1920
        // &player_preload={"expire_time":1655811359,"cid":730580971,"quality":80,"file_info":{"112":{"infos":[{"filesize":98565743,"timelength":238379}]},"16":{"infos":[{"filesize":8548255,"timelength":238379}]},"32":{"infos":[{"filesize":19120697,"timelength":238379}]},"64":{"infos":[{"filesize":42359328,"timelength":238379}]},"80":{"infos":[{"filesize":63440698,"timelength":238379}]}},"video_codecid":7,"video_project":true,"fnver":0,"fnval":400,"dash":{"video":[{"id":80,"base_url":"http://103.151.151.48/upgcxcode/71/09/730580971/730580971_x1-1-31101.m4s?e=ig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_\u0026uipk=5\u0026nbs=1\u0026deadline=1655814959\u0026gen=playurlv2\u0026os=bcache\u0026oi=2633568537\u0026trid=0000313bcd33a37d45ae80ff459677f7226bO\u0026mid=0\u0026platform=iphone\u0026upsig=a0fa507015f456e83fbb33d51293132b\u0026uparams=e,uipk,nbs,deadline,gen,os,oi,trid,mid,platform\u0026cdnid=9597\u0026bvc=vod\u0026nettype=1\u0026orderid=0,2\u0026bw=104616\u0026logo=80000000","bandwidth":835761,"codecid":12,"size":24898685,"backup_url":["http://upos-hz-mirrorakam.akamaized.net/upgcxcode/71/09/730580971/730580971_x1-1-31101.m4s?e=ig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_\u0026uipk=5\u0026nbs=1\u0026deadline=1655814959\u0026gen=playurlv2\u0026os=akam\u0026oi=2633568537\u0026trid=313bcd33a37d45ae80ff459677f7226bO\u0026mid=0\u0026platform=iphone\u0026upsig=a71daca15939b76a36023488154e047b\u0026uparams=e,uipk,nbs,deadline,gen,os,oi,trid,mid,platform\u0026hdnts=exp=1655814959~hmac=5a396aa1b76b6ee7099f661b975bc1c4af6384640b1e0782f02329ed9700c7c8\u0026bvc=vod\u0026nettype=1\u0026orderid=1,2\u0026bw=104616\u0026logo=40000000"],"frame_rate":"30.303"},{"id":80,"base_url":"http://103.151.151.52/upgcxcode/71/09/730580971/730580971_nb2-1-30080.m4s?e=ig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_\u0026uipk=5\u0026nbs=1\u0026deadline=1655814959\u0026gen=playurlv2\u0026os=bcache\u0026oi=2633568537\u0026trid=0000313bcd33a37d45ae80ff459677f7226bO\u0026mid=0\u0026platform=iphone\u0026upsig=bfaa4117c64c527735f81833a80777cc\u0026uparams=e,uipk,nbs,deadline,gen,os,oi,trid,mid,platform\u0026cdnid=9599\u0026bvc=vod\u0026nettype=1\u0026orderid=0,2\u0026bw=266557\u0026logo=80000000","bandwidth":2129480,"codecid":7,"size":63440698,"backup_url":["http://upos-hz-mirrorakam.akamaized.net/upgcxcode/71/09/730580971/730580971_nb2-1-30080.m4s?e=ig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_\u0026uipk=5\u0026nbs=1\u0026deadline=1655814959\u0026gen=playurlv2\u0026os=akam\u0026oi=2633568537\u0026trid=313bcd33a37d45ae80ff459677f7226bO\u0026mid=0\u0026platform=iphone\u0026upsig=345d39db44456c9bfb3bfed19011fff2\u0026uparams=e,uipk,nbs,deadline,gen,os,oi,trid,mid,platform\u0026hdnts=exp=1655814959~hmac=bebf1b723071d4ded0ab35477b400a98f411d1d7dd2acbb2b324c8bd6730a865\u0026bvc=vod\u0026nettype=1\u0026orderid=1,2\u0026bw=266557\u0026logo=40000000"],"frame_rate":"29.412"},{"id":32,"base_url":"http://103.151.151.44/upgcxcode/71/09/730580971/730580971_x1-1-31057.m4s?e=ig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_\u0026uipk=5\u0026nbs=1\u0026deadline=1655814959\u0026gen=playurlv2\u0026os=bcache\u0026oi=2633568537\u0026trid=0000313bcd33a37d45ae80ff459677f7226bO\u0026mid=0\u0026platform=iphone\u0026upsig=717bdc7fe772ea9baea8d4bc5082421e\u0026uparams=e,uipk,nbs,deadline,gen,os,oi,trid,mid,platform\u0026cdnid=9603\u0026bvc=vod\u0026nettype=1\u0026orderid=0,2\u0026bw=34737\u0026logo=80000000","bandwidth":277508,"codecid":12,"size":8267443,"backup_url":["http://upos-hz-mirrorakam.akamaized.net/upgcxcode/71/09/730580971/730580971_x1-1-31057.m4s?e=ig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_\u0026uipk=5\u0026nbs=1\u0026deadline=1655814959\u0026gen=playurlv2\u0026os=akam\u0026oi=2633568537\u0026trid=313bcd33a37d45ae80ff459677f7226bO\u0026mid=0\u0026platform=iphone\u0026upsig=ed6b11e4fb2ad818e96d09e27f28c7c1\u0026uparams=e,uipk,nbs,deadline,gen,os,oi,trid,mid,platform\u0026hdnts=exp=1655814959~hmac=614c3ad199f12fa8af9d38d8886edd7a1e6c5c6f9552152205075cdc1f463e06\u0026bvc=vod\u0026nettype=1\u0026orderid=1,2\u0026bw=34737\u0026logo=40000000"],"frame_rate":"30.303"},{"id":32,"base_url":"http://103.151.151.44/upgcxcode/71/09/730580971/730580971_nb2-1-30032.m4s?e=ig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_\u0026uipk=5\u0026nbs=1\u0026deadline=1655814959\u0026gen=playurlv2\u0026os=bcache\u0026oi=2633568537\u0026trid=0000313bcd33a37d45ae80ff459677f7226bO\u0026mid=0\u0026platform=iphone\u0026upsig=8a42b572d4c302cca152906252ca036d\u0026uparams=e,uipk,nbs,deadline,gen,os,oi,trid,mid,platform\u0026cdnid=9603\u0026bvc=vod\u0026nettype=1\u0026orderid=0,2\u0026bw=80339\u0026logo=80000000","bandwidth":641814,"codecid":7,"size":19120697,"backup_url":["http://upos-hz-mirrorakam.akamaized.net/upgcxcode/71/09/730580971/730580971_nb2-1-30032.m4s?e=ig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_\u0026uipk=5\u0026nbs=1\u0026deadline=1655814959\u0026gen=playurlv2\u0026os=akam\u0026oi=2633568537\u0026trid=313bcd33a37d45ae80ff459677f7226bO\u0026mid=0\u0026platform=iphone\u0026upsig=edf6de96983590736ebb06c6ccc14598\u0026uparams=e,uipk,nbs,deadline,gen,os,oi,trid,mid,platform\u0026hdnts=exp=1655814959~hmac=88a799bccc17b8ab46b8c0e0b1a4d39377f9b95fbb6b58d54f84cb1570c3f11f\u0026bvc=vod\u0026nettype=1\u0026orderid=1,2\u0026bw=80339\u0026logo=40000000"],"frame_rate":"29.412"}],"audio":[{"id":30216,"base_url":"http://103.151.151.52/upgcxcode/71/09/730580971/730580971_nb2-1-30216.m4s?e=ig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_\u0026uipk=5\u0026nbs=1\u0026deadline=1655814959\u0026gen=playurlv2\u0026os=bcache\u0026oi=2633568537\u0026trid=0000313bcd33a37d45ae80ff459677f7226bO\u0026mid=0\u0026platform=iphone\u0026upsig=84552df0b5dffdfa55643751af68a807\u0026uparams=e,uipk,nbs,deadline,gen,os,oi,trid,mid,platform\u0026cdnid=9599\u0026bvc=vod\u0026nettype=1\u0026orderid=0,2\u0026bw=8420\u0026logo=80000000","bandwidth":67241,"codecid":0,"size":2003973,"backup_url":["http://upos-hz-mirrorakam.akamaized.net/upgcxcode/71/09/730580971/730580971_nb2-1-30216.m4s?e=ig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_\u0026uipk=5\u0026nbs=1\u0026deadline=1655814959\u0026gen=playurlv2\u0026os=akam\u0026oi=2633568537\u0026trid=313bcd33a37d45ae80ff459677f7226bO\u0026mid=0\u0026platform=iphone\u0026upsig=a6d15073f6970d854e7f678672be12dd\u0026uparams=e,uipk,nbs,deadline,gen,os,oi,trid,mid,platform\u0026hdnts=exp=1655814959~hmac=916b1a3748be40eb10a6bf2a232e9837ed088c8cc3deaadc26e1ca53def2c81b\u0026bvc=vod\u0026nettype=1\u0026orderid=1,2\u0026bw=8420\u0026logo=40000000"]},{"id":30232,"base_url":"http://103.151.151.48/upgcxcode/71/09/730580971/730580971_nb2-1-30232.m4s?e=ig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_\u0026uipk=5\u0026nbs=1\u0026deadline=1655814959\u0026gen=playurlv2\u0026os=bcache\u0026oi=2633568537\u0026trid=0000313bcd33a37d45ae80ff459677f7226bO\u0026mid=0\u0026platform=iphone\u0026upsig=64bbc68dfbb2125ac2b673fea4735d9b\u0026uparams=e,uipk,nbs,deadline,gen,os,oi,trid,mid,platform\u0026cdnid=9597\u0026bvc=vod\u0026nettype=1\u0026orderid=0,2\u0026bw=16237\u0026logo=80000000","bandwidth":129672,"codecid":0,"size":3864606,"backup_url":["http://upos-hz-mirrorakam.akamaized.net/upgcxcode/71/09/730580971/730580971_nb2-1-30232.m4s?e=ig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_\u0026uipk=5\u0026nbs=1\u0026deadline=1655814959\u0026gen=playurlv2\u0026os=akam\u0026oi=2633568537\u0026trid=313bcd33a37d45ae80ff459677f7226bO\u0026mid=0\u0026platform=iphone\u0026upsig=5cff6b18cb7cfa5c855ca5b1e28f24f5\u0026uparams=e,uipk,nbs,deadline,gen,os,oi,trid,mid,platform\u0026hdnts=exp=1655814959~hmac=a123bfeed63a6e7ef54a447a27896e79379b83076fcf5f0b5771af7ca26e9597\u0026bvc=vod\u0026nettype=1\u0026orderid=1,2\u0026bw=16237\u0026logo=40000000"]},{"id":30280,"base_url":"http://103.151.151.45/upgcxcode/71/09/730580971/730580971_nb2-1-30280.m4s?e=ig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_\u0026uipk=5\u0026nbs=1\u0026deadline=1655814959\u0026gen=playurlv2\u0026os=bcache\u0026oi=2633568537\u0026trid=0000313bcd33a37d45ae80ff459677f7226bO\u0026mid=0\u0026platform=iphone\u0026upsig=4624e9344a4120f4080d9d48a7188930\u0026uparams=e,uipk,nbs,deadline,gen,os,oi,trid,mid,platform\u0026cdnid=9604\u0026bvc=vod\u0026nettype=1\u0026orderid=0,2\u0026bw=16237\u0026logo=80000000","bandwidth":129672,"codecid":0,"size":3864606,"backup_url":["http://upos-hz-mirrorakam.akamaized.net/upgcxcode/71/09/730580971/730580971_nb2-1-30280.m4s?e=ig8euxZM2rNcNbdlhoNvNC8BqJIzNbfqXBvEuENvNC8aNEVEtEvE9IMvXBvE2ENvNCImNEVEIj0Y2J_aug859r1qXg8gNEVE5XREto8z5JZC2X2gkX5L5F1eTX1jkXlsTXHeux_f2o859IB_\u0026uipk=5\u0026nbs=1\u0026deadline=1655814959\u0026gen=playurlv2\u0026os=akam\u0026oi=2633568537\u0026trid=313bcd33a37d45ae80ff459677f7226bO\u0026mid=0\u0026platform=iphone\u0026upsig=ee320933e6f35074b52d3328d8cbae43\u0026uparams=e,uipk,nbs,deadline,gen,os,oi,trid,mid,platform\u0026hdnts=exp=1655814959~hmac=fff28407f80744f46b2ceaf5dac69573c0033f240db52094d4e6b824635a477c\u0026bvc=vod\u0026nettype=1\u0026orderid=1,2\u0026bw=16237\u0026logo=40000000"]}]},"accept_formats":[{"quality":112,"format":"hdflv2","description":"高清 1080P+","new_description":"1080P 高码率","display_desc":"1080P","superscript":"高码率","need_vip":true,"need_login":true},{"quality":80,"format":"flv","description":"高清 1080P","new_description":"1080P 高清","display_desc":"1080P","need_login":true},{"quality":64,"format":"flv720","description":"高清 720P","new_description":"720P 高清","display_desc":"720P","need_login":true},{"quality":32,"format":"flv480","description":"清晰 480P","new_description":"480P 清晰","display_desc":"480P"},{"quality":16,"format":"mp4","description":"流畅 360P","new_description":"360P 流畅","display_desc":"360P"}]}
        // &player_rotate=0
        // &player_width=1080
    }

    @Test
    fun detailVideo() {
        val aid = "554902946"
        BiliCore.init(context = mockContext)

        val net = VideoFlowNet()
        var detailVideo = net.detailVideo(aid)
        val videoUrl = detailVideo[0].videos?.get(0)?.base_url
        assert(videoUrl?.isNotEmpty() == true)
        val path = net.download("video", videoUrl!!)
        println("download video $path")
    }
}